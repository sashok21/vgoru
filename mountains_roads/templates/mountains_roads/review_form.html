{% extends 'mountains_roads/base.html' %}

{% block title %}Написати відгук - Гірські маршрути{% endblock %}

{% block content %}
    <div class="container">
        <div class="review-form-container">
            <h2><i class="fa-solid fa-pen-nib"></i> {% if form.instance.id %}Редагування{% else %}Написання{% endif %}
                відгуку</h2>

            {% if form.instance.route %}
                <div class="route-info">
                    <strong>Маршрут:</strong> {{ form.instance.route.name }} ({{ form.instance.route.height }} м)
                </div>
            {% endif %}

            <form method="post" novalidate>
                {% csrf_token %}

                {% if form.non_field_errors %}
                    <div style="background: #ffebee; color: #c62828; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                        {% for error in form.non_field_errors %}
                            <p>{{ error }}</p>
                        {% endfor %}
                    </div>
                {% endif %}

                <div class="form-group">
                    <label>Ваша оцінка:</label>
                    <div class="rating-input">
                        {% for value, label in form.fields.rating.widget.choices %}
                            <input type="radio" id="id_rating_{{ value }}" name="rating" value="{{ value }}"
                                   {% if form.rating.value == value %}checked{% endif %}>
                            <label for="id_rating_{{ value }}" style="margin: 0;">
                                {% for i in "12345" %}
                                    {% if forloop.counter <= value %}
                                        <i class="fa-solid fa-star" style="color: #ffc107;"></i>
                                    {% else %}
                                        <i class="fa-regular fa-star" style="color: #e0e0e0;"></i>
                                    {% endif %}
                                {% endfor %}
                            </label>
                        {% endfor %}
                    </div>
                    {% if form.rating.errors %}
                        <ul style="color: #ff6b6b; list-style: none; padding: 0; margin: 0.5rem 0;">
                            {% for error in form.rating.errors %}
                                <li style="font-size: 0.85rem;">{{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.title.id_for_label }}">{{ form.title.label }}</label>
                    {{ form.title }}
                    {% if form.title.errors %}
                        <ul style="color: #ff6b6b; list-style: none; padding: 0; margin: 0.5rem 0;">
                            {% for error in form.title.errors %}
                                <li style="font-size: 0.85rem;">{{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.text.id_for_label }}">{{ form.text.label }}</label>
                    {{ form.text }}
                    {% if form.text.errors %}
                        <ul style="color: #ff6b6b; list-style: none; padding: 0; margin: 0.5rem 0;">
                            {% for error in form.text.errors %}
                                <li style="font-size: 0.85rem;">{{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>

                <div class="form-buttons">
                    <button type="submit"><i class="fa-solid fa-floppy-disk"></i> {% if form.instance.id %}Зберегти
                        зміни{% else %}Додати відгук{% endif %}</button>
                    <a href="{% url 'route-detail' form.instance.route.id %}">Скасувати</a>
                </div>
            </form>
        </div>
    </div>
{% endblock %}